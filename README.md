### Free Wilson Analysis

This code provides a Python implementation of the Free-Wilson SAR analysis method as described in

Spencer M. Free and James W. Wilson  
A mathematical contribution to structure-activity studies  
 *Journal of Medicinal Chemistry* 7.4 (1964): 395-399.
 
### Installation

1. This software requires an anaconda environment with the RDKit (at least 2018.3) installed. 
http://www.rdkit.org/docs/Install.html  
The code uses a lot type hints so you'll probably need at least Python 3.6.


2. Install dependencies  
```commandline
pip install docopt tqdm pyfancy sklearn scipy
```
 
### Usage
A detailed tutorial introduction can be found at http://practicalcheminformatics.blogspot.com/2018/05/free-wilson-analysis.html

As a demo, go to the data directory and run the command below 
```commandline
../free_wilson.py all --scaffold scaffold.mol --in fw_mols.smi --act fw_act.csv --prefix test
```
Quite a few other options are also available.  
```commandline
Usage:
free_wilson.py all --scaffold SCAFFOLD_MOLFILE --in INPUT_SMILES_FILE --prefix JOB_PREFIX --act ACTIVITY_FILE [--log]
free_wilson.py rgroup --scaffold SCAFFOLD_MOLFILE --in INPUT_SMILES_FILE --prefix JOB_PREFIX
free_wilson.py regression --desc DESCRIPTOR_FILE --act ACTIVITY_FILE --prefix JOB_PREFIX [--log]
free_wilson.py enumeration --scaffold SCAFFOLD_SMILES --model MOLDEL_FILE --desc DESCRIPTOR_FILE --prefix JOB_PREFIX

Options:
--scaffold SCAFFOLD_MOLFILE molfile for the scaffold
--in INPUT_SMILES_FILE input SMILES file
--prefix JOB_PREFIX job prefix
--desc DESCRIPTOR_FILE as generated by the "rgroup" command
--act ACTIVITY_FILE activity columns should be
--model MODEL_FILE names of the model file created by the "regression" command
```

The program creates a number of output files  
- prefix_rgroup.csv - R-group decomposition of the input molecules based on the scaffold molfile
- prefix_vector.csv - R-groups transposed to a vector of descriptors
- prefix_lm.pkl - Linear model pickled 
- prefix_comparison.csv - Comparison of predicted and experimental activities
- prefix_coefficients.csv - Coefficients for the linear model
- prefix_not_synthesized.csv - R-group combinations not in the input SMILES file along with predicted activities



